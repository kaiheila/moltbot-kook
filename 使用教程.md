# Moltbot + Kook 插件使用教程

通过 Kook 机器人向你的电脑发送信息，实现远程 AI 助手功能。

## 第一步：安装 Moltbot

**如果你已经安装了 Moltbot，请直接跳到 [第二步](#第二步安装-kook-插件)。**


### 1.1 安装 Moltbot

环境要求及安装过程可以直接查看官方文档： https://docs.molt.bot/start/getting-started

### 1.2 初始化配置

首次运行 Moltbot：

```bash
moltbot setup
```

按照提示完成基础配置：
- 选择 AI 模型（OpenAI、Claude、MiniMax 等）
- 配置 API Key
- 设置其他基础选项
- Channel 这里选择“Skip for Now”，暂时跳过，后面配置KOOK。
image.png

### 1.3 启动 Moltbot

```bash
moltbot gateway start
```

Moltbot 会在后台运行，默认监听 `http://127.0.0.1:18789`。

---

## 第二步：安装 Kook 插件

### 2.1 安装插件

在终端执行：

```bash
moltbot plugins install @kookapp/moltbot-kook
```

等待安装完成，你会看到类似提示：

```
✓ 已安装 @kookapp/moltbot-kook
```

---

## 第三步：获取 Kook Bot Token

### 3.1 创建 Kook 机器人

1. 访问 [Kook 开发者平台](https://developer.kookapp.cn/bot/)
2. 登录你的 Kook 账号
3. 点击「创建机器人」
4. 填写机器人信息：
   - **机器人名称**：例如 "我的AI助手"
   - **机器人头像**：上传一个头像图片
   - **简介**：可选填写

### 3.2 获取 Bot Token

1. 在机器人管理页面，找到 **Token** 部分
2. 点击「点击显示」或「复制」按钮
3. **妥善保存这个 Token**，后续配置需要用到

⚠️ **注意**：Token 相当于机器人的密码，请勿泄露给他人！

### 3.3 邀请机器人到服务器

1. 在机器人页面找到「机器人邀请链接」
2. 复制链接并在浏览器中打开
3. 选择要添加机器人的服务器
4. 确认授权

---

## 第四步：配置 Kook 插件

### 方式一：通过 Web 界面配置（推荐）

#### 4.1 打开配置页面

在浏览器中访问：

```
http://127.0.0.1:18789/chat
```

#### 4.2 进入设置

1. 点击页面右上角的「设置」或「配置」按钮
2. 在左侧菜单找到「Channels」或「通道」
3. 找到「Kook」选项

#### 4.3 填写配置

需要配置的参数：

| 配置项 | 说明 | 示例 |
|--------|------|------|
| **Token** | 第三步获取的 Bot Token | `1/abc123...` |
| **Allowed User ID** | 你的 Kook 用户 ID（见下方获取方法） | `1234567890` |

**如何获取你的 Kook 用户 ID：**

**方法一（推荐）：通过 Kook 客户端**
1. 打开 Kook 客户端
2. 点击左下角「个人设置」
3. 进入「高级设置」
4. 开启「开发者模式」
5. 在任意服务器频道中，右键点击自己的头像
6. 选择「复制 ID」
7. 这就是你的用户 ID

**方法二：通过日志查看**
1. 暂时不填 Allowed User ID，先保存 Token
2. 重启 Moltbot
3. 在 Kook 中给机器人发送一条消息，例如 "你好"
4. 查看 Moltbot 日志
 ```bash
   moltbot logs | grep -i kook
   ```
找到类似内容：
   ```
   Message from 1234567890 rejected: not in allowedUserId
   ```

5. `1234567890` 就是你的用户 ID
6. 回到配置页面，填入这个用户 ID 并保存

#### 4.4 保存配置

点击「保存」或「应用」按钮。

### 方式二：通过命令行配置

```bash
# 设置 Bot Token
moltbot config set channels.kook.token "你的Bot Token"

# 设置允许的用户 ID
moltbot config set channels.kook.allowedUserId "你的用户ID"

# 启用 Kook 通道
moltbot config set channels.kook.enabled true
```

### 方式三：通过配置文件

Moltbot 的配置文件通常位于：

- **Linux/Mac**: `~/.moltbot/config.json`
- **Windows**: `C:\Users\你的用户名\.moltbot\config.json`

完整配置示例

```json
{
  "channels": {
    "kook": {
      "enabled": true,
      "token": "1/abc123...",
      "allowedUserId": "1234567890"
    }
  }
}
```

---

## 第五步：重启 Moltbot

配置完成后，重启 Moltbot 使配置生效：

```bash
moltbot gateway restart
```

查看状态：

```bash
moltbot gateway status
```

你应该看到类似输出：

```
✓ Moltbot Gateway 运行中
✓ Kook 通道已连接
```

---

## 第六步：开始使用

### 6.1 发送第一条消息

在 Kook 中找到你的机器人：
1. 打开 Kook 应用
2. 在聊天列表中找到你的机器人
3. 发送消息测试：

```
你好，请介绍一下自己
```

机器人应该会回复你！

### 6.2 常用命令

- **普通对话**：直接发送消息即可
- **新建会话**：发送 `/new` 开启新对话
- **查看帮助**：发送 `/help` 查看可用命令

### 6.3 高级用法

#### 执行系统命令

```
请帮我查看当前目录的文件列表
```

机器人会帮你执行 `ls` 或 `dir` 命令并返回结果。

#### 文件操作

```
请在桌面创建一个名为 test.txt 的文件
```

#### 查询信息

```
帮我查看今天的天气
```

---

## 安全说明

### 为什么需要配置 Allowed User ID？

- ✅ **防止未授权访问**：只有指定的用户 ID 可以控制你的电脑
- ✅ **远程控制安全**：避免机器人被他人滥用
- ✅ **隐私保护**：确保只有你能访问你的文件和系统

### 安全建议

1. **不要泄露 Bot Token**：Token 泄露会导致机器人被他人控制
2. **设置 Allowed User ID**：强烈建议配置，限制只有你可以使用
3. **定期检查日志**：查看是否有异常访问记录
4. **谨慎授权权限**：不要给机器人过高的系统权限



